/*
 * jQuery Form Plugin
 * version: 3.09 (16-APR-2012)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
(function(e){var b={};b.fileapi=e("<input type='file'/>").get(0).files!==undefined;b.formdata=window.FormData!==undefined;e.fn.ajaxSubmit=function(n){if(!this.length){d("ajaxSubmit: skipping submit process - no element selected");return this}var o,y,i,m=this;if(typeof n=="function"){n={success:n}}o=this.attr("method");y=this.attr("action");i=(typeof y==="string")?e.trim(y):"";i=i||window.location.href||"";if(i){i=(i.match(/^([^#]+)/)||[])[1]}n=e.extend(true,{url:i,success:e.ajaxSettings.success,type:o||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var t={};this.trigger("form-pre-serialize",[this,n,t]);if(t.veto){d("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===false){d("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var l=n.traditional;if(l===undefined){l=e.ajaxSettings.traditional}var g=[];var z,A=this.formToArray(n.semantic,g);if(n.data){n.extraData=n.data;z=e.param(n.data,l)}if(n.beforeSubmit&&n.beforeSubmit(A,this,n)===false){d("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[A,this,n,t]);if(t.veto){d("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var u=e.param(A,l);if(z){u=(u?(u+"&"+z):z)}if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+u;n.data=null}else{n.data=u}var s=[];if(n.resetForm){s.push(function(){m.resetForm()})}if(n.clearForm){s.push(function(){m.clearForm(n.includeHidden)})}if(!n.dataType&&n.target){var h=n.success||function(){};s.push(function(q){var k=n.replaceTarget?"replaceWith":"html";e(n.target)[k](q).each(h,arguments)})}else{if(n.success){s.push(n.success)}}n.success=function(F,E,G){var D=n.context||n;for(var q=0,k=s.length;q<k;q++){s[q].apply(D,[F,E,G||m,m])}};var x=e("input:file:enabled[value]",this);var j=x.length>0;var w="multipart/form-data";var C=(m.attr("enctype")==w||m.attr("encoding")==w);var B=b.fileapi&&b.formdata;d("fileAPI :"+B);var f=(j||C)&&!B;if(n.iframe!==false&&(n.iframe||f)){if(n.closeKeepAlive){e.get(n.closeKeepAlive,function(){r(A)})}else{r(A)}}else{if((j||C)&&B){p(A)}else{e.ajax(n)}}for(var v=0;v<g.length;v++){g[v]=null}this.trigger("form-submit-notify",[this,n]);return this;function p(q){var k=new FormData();for(var D=0;D<q.length;D++){k.append(q[D].name,q[D].value)}if(n.extraData){for(var G in n.extraData){if(n.extraData.hasOwnProperty(G)){k.append(G,n.extraData[G])}}}n.data=null;var F=e.extend(true,{},e.ajaxSettings,n,{contentType:false,processData:false,cache:false,type:"POST"});if(n.uploadProgress){F.xhr=function(){var H=jQuery.ajaxSettings.xhr();if(H.upload){H.upload.onprogress=function(L){var J=0;var I=L.loaded||L.position;var K=L.total;if(L.lengthComputable){J=Math.ceil(I/K*100)}n.uploadProgress(L,I,K,J)}}return H}}F.data=null;var E=F.beforeSend;F.beforeSend=function(I,H){H.data=k;if(E){E.call(H,I,n)}};e.ajax(F)}function r(ab){var F=m[0],G,X,R,Z,U,J,M,L,K,V,Y,Q;var H=!!e.fn.prop;if(e(":input[name=submit],:input[id=submit]",F).length){alert('Error: Form elements must not have name or id of "submit".');return}if(ab){for(X=0;X<g.length;X++){G=e(g[X]);if(H){G.prop("disabled",false)}else{G.removeAttr("disabled")}}}R=e.extend(true,{},e.ajaxSettings,n);R.context=R.context||R;U="jqFormIO"+(new Date().getTime());if(R.iframeTarget){J=e(R.iframeTarget);V=J.attr("name");if(!V){J.attr("name",U)}else{U=V}}else{J=e('<iframe name="'+U+'" src="'+R.iframeSrc+'" />');J.css({position:"absolute",top:"-1000px",left:"-1000px"})}M=J[0];L={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ae){var af=(ae==="timeout"?"timeout":"aborted");d("aborting upload... "+af);this.aborted=1;J.attr("src",R.iframeSrc);L.error=af;if(R.error){R.error.call(R.context,L,af,ae)}if(Z){e.event.trigger("ajaxError",[L,R,af])}if(R.complete){R.complete.call(R.context,L,af)}}};Z=R.global;if(Z&&0===e.active++){e.event.trigger("ajaxStart")}if(Z){e.event.trigger("ajaxSend",[L,R])}if(R.beforeSend&&R.beforeSend.call(R.context,L,R)===false){if(R.global){e.active--}return}if(L.aborted){return}K=F.clk;if(K){V=K.name;if(V&&!K.disabled){R.extraData=R.extraData||{};R.extraData[V]=K.value;if(K.type=="image"){R.extraData[V+".x"]=F.clk_x;R.extraData[V+".y"]=F.clk_y}}}var k=1;var N=2;function E(af){var ae=af.contentWindow?af.contentWindow.document:af.contentDocument?af.contentDocument:af.document;return ae}var D=e("meta[name=csrf-token]").attr("content");var q=e("meta[name=csrf-param]").attr("content");if(q&&D){R.extraData=R.extraData||{};R.extraData[q]=D}function W(){var ah=m.attr("target"),ae=m.attr("action");F.setAttribute("target",U);if(!o){F.setAttribute("method","POST")}if(ae!=R.url){F.setAttribute("action",R.url)}if(!R.skipEncodingOverride&&(!o||/post/i.test(o))){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(R.timeout){Q=setTimeout(function(){Y=true;T(k)},R.timeout)}function ag(){try{var aj=E(M).readyState;d("state = "+aj);if(aj&&aj.toLowerCase()=="uninitialized"){setTimeout(ag,50)}}catch(ak){d("Server abort: ",ak," (",ak.name,")");T(N);if(Q){clearTimeout(Q)}Q=undefined}}var af=[];try{if(R.extraData){for(var ai in R.extraData){if(R.extraData.hasOwnProperty(ai)){af.push(e('<input type="hidden" name="'+ai+'">').attr("value",R.extraData[ai]).appendTo(F)[0])}}}if(!R.iframeTarget){J.appendTo("body");if(M.attachEvent){M.attachEvent("onload",T)}else{M.addEventListener("load",T,false)}}setTimeout(ag,15);F.submit()}finally{F.setAttribute("action",ae);if(ah){F.setAttribute("target",ah)}else{m.removeAttr("target")}e(af).remove()}}if(R.forceSync){W()}else{setTimeout(W,10)}var ac,ad,aa=50,I;function T(al){if(L.aborted||I){return}try{ad=E(M)}catch(am){d("cannot access response document: ",am);al=N}if(al===k&&L){L.abort("timeout");return}else{if(al==N&&L){L.abort("server abort");return}}if(!ad||ad.location.href==R.iframeSrc){if(!Y){return}}if(M.detachEvent){M.detachEvent("onload",T)}else{M.removeEventListener("load",T,false)}var ah="success",ae;try{if(Y){throw"timeout"}var ai=R.dataType=="xml"||ad.XMLDocument||e.isXMLDoc(ad);d("isXml="+ai);if(!ai&&window.opera&&(ad.body===null||!ad.body.innerHTML)){if(--aa){d("requeing onLoad callback, DOM not available");setTimeout(T,250);return}}var an=ad.body?ad.body:ad.documentElement;L.responseText=an?an.innerHTML:null;L.responseXML=ad.XMLDocument?ad.XMLDocument:ad;if(ai){R.dataType="xml"}L.getResponseHeader=function(ap){var aq={"content-type":R.dataType};return aq[ap]};if(an){L.status=Number(an.getAttribute("status"))||L.status;L.statusText=an.getAttribute("statusText")||L.statusText}var af=(R.dataType||"").toLowerCase();var ak=/(json|script|text)/.test(af);if(ak||R.textarea){var aj=ad.getElementsByTagName("textarea")[0];if(aj){L.responseText=aj.value;L.status=Number(aj.getAttribute("status"))||L.status;L.statusText=aj.getAttribute("statusText")||L.statusText}else{if(ak){var ag=ad.getElementsByTagName("pre")[0];var ao=ad.getElementsByTagName("body")[0];if(ag){L.responseText=ag.textContent?ag.textContent:ag.innerText}else{if(ao){L.responseText=ao.textContent?ao.textContent:ao.innerText}}}}}else{if(af=="xml"&&!L.responseXML&&L.responseText){L.responseXML=S(L.responseText)}}try{ac=O(L,af,R)}catch(al){ah="parsererror";L.error=ae=(al||ah)}}catch(al){d("error caught: ",al);ah="error";L.error=ae=(al||ah)}if(L.aborted){d("upload aborted");ah=null}if(L.status){ah=(L.status>=200&&L.status<300||L.status===304)?"success":"error"}if(ah==="success"){if(R.success){R.success.call(R.context,ac,"success",L)}if(Z){e.event.trigger("ajaxSuccess",[L,R])}}else{if(ah){if(ae===undefined){ae=L.statusText}if(R.error){R.error.call(R.context,L,ah,ae)}if(Z){e.event.trigger("ajaxError",[L,R,ae])}}}if(Z){e.event.trigger("ajaxComplete",[L,R])}if(Z&&!--e.active){e.event.trigger("ajaxStop")}if(R.complete){R.complete.call(R.context,L,ah)}I=true;if(R.timeout){clearTimeout(Q)}setTimeout(function(){if(!R.iframeTarget){J.remove()}L.responseXML=null},100)}var S=e.parseXML||function(ae,af){if(window.ActiveXObject){af=new ActiveXObject("Microsoft.XMLDOM");af.async="false";af.loadXML(ae)}else{af=(new DOMParser()).parseFromString(ae,"text/xml")}return(af&&af.documentElement&&af.documentElement.nodeName!="parsererror")?af:null};var P=e.parseJSON||function(ae){return window["eval"]("("+ae+")")};var O=function(aj,ah,ag){var af=aj.getResponseHeader("content-type")||"",ae=ah==="xml"||!ah&&af.indexOf("xml")>=0,ai=ae?aj.responseXML:aj.responseText;if(ae&&ai.documentElement.nodeName==="parsererror"){if(e.error){e.error("parsererror")}}if(ag&&ag.dataFilter){ai=ag.dataFilter(ai,ah)}if(typeof ai==="string"){if(ah==="json"||!ah&&af.indexOf("json")>=0){ai=P(ai)}else{if(ah==="script"||!ah&&af.indexOf("javascript")>=0){e.globalEval(ai)}}}return ai}}};e.fn.ajaxForm=function(f){f=f||{};f.delegation=f.delegation&&e.isFunction(e.fn.on);if(!f.delegation&&this.length===0){var g={s:this.selector,c:this.context};if(!e.isReady&&g.s){d("DOM not ready, queuing ajaxForm");e(function(){e(g.s,g.c).ajaxForm(f)});return this}d("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(f.delegation){e(document).off("submit.form-plugin",this.selector,c).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,f,c).on("click.form-plugin",this.selector,f,a);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",f,c).bind("click.form-plugin",f,a)};function c(g){var f=g.data;if(!g.isDefaultPrevented()){g.preventDefault();e(this).ajaxSubmit(f)}}function a(i){var k=i.target;var g=e(k);if(!(g.is(":submit,input:image"))){var f=g.closest(":submit");if(f.length===0){return}k=f[0]}var h=this;h.clk=k;if(k.type=="image"){if(i.offsetX!==undefined){h.clk_x=i.offsetX;h.clk_y=i.offsetY}else{if(typeof e.fn.offset=="function"){var j=g.offset();h.clk_x=i.pageX-j.left;h.clk_y=i.pageY-j.top}else{h.clk_x=i.pageX-k.offsetLeft;h.clk_y=i.pageY-k.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)}e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(w,q){var u=[];if(this.length===0){return u}var h=this[0];var o=w?h.getElementsByTagName("*"):h.elements;if(!o){return u}var p,m,l,x,k,s,g;for(p=0,s=o.length;p<s;p++){k=o[p];l=k.name;if(!l){continue}if(w&&h.clk&&k.type=="image"){if(!k.disabled&&h.clk==k){u.push({name:l,value:e(k).val(),type:k.type});u.push({name:l+".x",value:h.clk_x},{name:l+".y",value:h.clk_y})}continue}x=e.fieldValue(k,true);if(x&&x.constructor==Array){if(q){q.push(k)}for(m=0,g=x.length;m<g;m++){u.push({name:l,value:x[m]})}}else{if(b.fileapi&&k.type=="file"&&!k.disabled){if(q){q.push(k)}var f=k.files;if(f.length){for(m=0;m<f.length;m++){u.push({name:l,value:f[m],type:k.type})}}else{u.push({name:l,value:"",type:k.type})}}else{if(x!==null&&typeof x!="undefined"){if(q){q.push(k)}u.push({name:l,value:x,type:k.type,required:k.required})}}}}if(!w&&h.clk){var r=e(h.clk),t=r[0];l=t.name;if(l&&!t.disabled&&t.type=="image"){u.push({name:l,value:r.val()});u.push({name:l+".x",value:h.clk_x},{name:l+".y",value:h.clk_y})}}return u};e.fn.formSerialize=function(f){return e.param(this.formToArray(f))};e.fn.fieldSerialize=function(g){var f=[];this.each(function(){var l=this.name;if(!l){return}var j=e.fieldValue(this,g);if(j&&j.constructor==Array){for(var k=0,h=j.length;k<h;k++){f.push({name:l,value:j[k]})}}else{if(j!==null&&typeof j!="undefined"){f.push({name:this.name,value:j})}}});return e.param(f)};e.fn.fieldValue=function(k){for(var l=[],h=0,f=this.length;h<f;h++){var j=this[h];var g=e.fieldValue(j,k);if(g===null||typeof g=="undefined"||(g.constructor==Array&&!g.length)){continue}if(g.constructor==Array){e.merge(l,g)}else{l.push(g)}}return l};e.fieldValue=function(g,h){var j=g.name,s=g.type,u=g.tagName.toLowerCase();if(h===undefined){h=true}if(h&&(!j||g.disabled||s=="reset"||s=="button"||(s=="checkbox"||s=="radio")&&!g.checked||(s=="submit"||s=="image")&&g.form&&g.form.clk!=g||u=="select"&&g.selectedIndex==-1)){return null}if(u=="select"){var o=g.selectedIndex;if(o<0){return null}var q=[],f=g.options;var l=(s=="select-one");var p=(l?o+1:f.length);for(var k=(l?o:0);k<p;k++){var m=f[k];if(m.selected){var r=m.value;if(!r){r=(m.attributes&&m.attributes.value&&!(m.attributes.value.specified))?m.text:m.value}if(l){return r}q.push(r)}}return q}return e(g).val()};e.fn.clearForm=function(f){return this.each(function(){e("input,select,textarea",this).clearFields(f)})};e.fn.clearFields=e.fn.clearInputs=function(f){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,h=this.tagName.toLowerCase();if(g.test(i)||h=="textarea"){this.value=""}else{if(i=="checkbox"||i=="radio"){this.checked=false}else{if(h=="select"){this.selectedIndex=-1}else{if(f){if((f===true&&/hidden/.test(i))||(typeof f=="string"&&e(this).is(f))){this.value=""}}}}}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};e.fn.enable=function(f){if(f===undefined){f=true}return this.each(function(){this.disabled=!f})};e.fn.selected=function(f){if(f===undefined){f=true}return this.each(function(){var g=this.type;if(g=="checkbox"||g=="radio"){this.checked=f}else{if(this.tagName.toLowerCase()=="option"){var h=e(this).parent("select");if(f&&h[0]&&h[0].type=="select-one"){h.find("option").selected(false)}this.selected=f}}})};e.fn.ajaxSubmit.debug=false;function d(){if(!e.fn.ajaxSubmit.debug){return}var f="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(f)}else{if(window.opera&&window.opera.postError){window.opera.postError(f)}}}})(jQuery);